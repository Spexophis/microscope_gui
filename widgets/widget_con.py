from PyQt5 import QtWidgets, QtCore

from utilities import customized_widgets as cw


class ConWidget(QtWidgets.QWidget):
    Signal_check_emccd_temperature = QtCore.pyqtSignal()
    Signal_switch_emccd_cooler = QtCore.pyqtSignal(bool)
    Signal_piezo_move = QtCore.pyqtSignal(str, float)
    Signal_deck_move_single_step = QtCore.pyqtSignal(bool)
    Signal_deck_move_continuous = QtCore.pyqtSignal(bool)
    Signal_galvo_set = QtCore.pyqtSignal()
    Signal_set_laser = QtCore.pyqtSignal(list, bool)
    Signal_plot_trigger = QtCore.pyqtSignal()
    Signal_video = QtCore.pyqtSignal(bool)
    Signal_fft = QtCore.pyqtSignal(bool)
    Signal_plot_profile = QtCore.pyqtSignal(bool)
    Signal_data_acquire = QtCore.pyqtSignal()
    Signal_save_file = QtCore.pyqtSignal(str)

    def __init__(self, config, logg, path, *args, **kwargs):

        super().__init__(*args, **kwargs)

        self.config = config
        self.logg = logg
        self.data_folder = path

        layout = QtWidgets.QVBoxLayout()
        dock_Camera, group_Camera = cw.create_dock('Camera')
        dock_Position, group_Position = cw.create_dock('Position')
        dock_Illumination, group_Illumination = cw.create_dock('Laser')
        dock_LiveVideo, group_LiveVideo = cw.create_dock('Live Video')
        dock_DataAcquisition, group_DataAcquisition = cw.create_dock('Data Acquisition')
        layout.addWidget(dock_Camera)
        layout.addWidget(dock_Position)
        layout.addWidget(dock_Illumination)
        layout.addWidget(dock_LiveVideo)
        layout.addWidget(dock_DataAcquisition)
        self.setLayout(layout)

        Layout_Camera = QtWidgets.QHBoxLayout()
        self.QComboBox_emccd = cw.combobox_widget(list_items=['Main', 'WFS', 'Field'])
        self.QComboBox_emccd.setCurrentIndex(0)
        self.QLCDNumber_ccd_tempetature = cw.lcdnumber_widget(0, 3)
        self.QPushButton_emccd_cooler_check = cw.pushbutton_widget('Check', False, True)
        self.QPushButton_emccd_cooler_switch = cw.pushbutton_widget('Cooler OFF', True, True, True)
        self.QDoubleSpinBox_emccd_exposure_time = cw.doublespinbox_widget(0, 10, 0.005, 3, 0.02)
        self.QSpinBox_emccd_gain = cw.spinbox_widget(0, 300, 1, 0)
        self.QSpinBox_emccd_coordinate_x = cw.spinbox_widget(0, 1024, 1, 1)
        self.QSpinBox_emccd_coordinate_y = cw.spinbox_widget(0, 1024, 1, 1)
        self.QSpinBox_emccd_coordinate_n = cw.spinbox_widget(0, 1024, 1, 1024)
        self.QSpinBox_emccd_coordinate_bin = cw.spinbox_widget(0, 1024, 1, 1)
        self.QDoubleSpinBox_ttl_start_emccd = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.012)
        self.QDoubleSpinBox_ttl_stop_emccd = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.015)
        self.emccd_scroll_area, emccd_scroll_layout = cw.create_scroll_area()
        emccd_scroll_layout.addRow(cw.label_widget(str('EMCCD')), self.QComboBox_emccd)
        emccd_scroll_layout.addRow(cw.frame_widget())
        emccd_scroll_layout.addRow(cw.label_widget(str('Temperature')), self.QLCDNumber_ccd_tempetature)
        emccd_scroll_layout.addRow(self.QPushButton_emccd_cooler_check, self.QPushButton_emccd_cooler_switch)
        emccd_scroll_layout.addRow(cw.label_widget(str('EMGain')), self.QSpinBox_emccd_gain)
        emccd_scroll_layout.addRow(cw.label_widget(str('X')), self.QSpinBox_emccd_coordinate_x)
        emccd_scroll_layout.addRow(cw.label_widget(str('Y')), self.QSpinBox_emccd_coordinate_y)
        emccd_scroll_layout.addRow(cw.label_widget(str('N')), self.QSpinBox_emccd_coordinate_n)
        emccd_scroll_layout.addRow(cw.label_widget(str('Bin')), self.QSpinBox_emccd_coordinate_bin)
        emccd_scroll_layout.addRow(cw.label_widget(str('Exposure / s')), self.QDoubleSpinBox_emccd_exposure_time)
        emccd_scroll_layout.addRow(cw.label_widget(str('From / s')), cw.label_widget(str('To / s')))
        emccd_scroll_layout.addRow(self.QDoubleSpinBox_ttl_start_emccd, self.QDoubleSpinBox_ttl_stop_emccd)
        self.QComboBox_scmos = cw.combobox_widget(list_items=['Main', 'WFS', 'Field'])
        self.QComboBox_scmos.setCurrentIndex(1)
        self.QDoubleSpinBox_scmos_exposure_time = cw.doublespinbox_widget(0, 10, 0.005, 3, 0.01)
        self.QSpinBox_scmos_coordinate_x = cw.spinbox_widget(0, 2048, 1, 0)
        self.QSpinBox_scmos_coordinate_y = cw.spinbox_widget(0, 2048, 1, 0)
        self.QSpinBox_scmos_coordinate_n = cw.spinbox_widget(0, 2048, 1, 2048)
        self.QSpinBox_scmos_coordinate_bin = cw.spinbox_widget(0, 2048, 1, 1)
        self.QDoubleSpinBox_ttl_start_scmos = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.000)
        self.QDoubleSpinBox_ttl_stop_scmos = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.000)
        self.scmos_scroll_area, scmos_scroll_layout = cw.create_scroll_area()
        scmos_scroll_layout.addRow(cw.label_widget(str('sCMOS')), self.QComboBox_scmos)
        scmos_scroll_layout.addRow(cw.frame_widget())
        scmos_scroll_layout.addRow(cw.label_widget(str('Exposure / s')), self.QDoubleSpinBox_scmos_exposure_time)
        scmos_scroll_layout.addRow(cw.label_widget(str('X')), self.QSpinBox_scmos_coordinate_x)
        scmos_scroll_layout.addRow(cw.label_widget(str('Y')), self.QSpinBox_scmos_coordinate_y)
        scmos_scroll_layout.addRow(cw.label_widget(str('N')), self.QSpinBox_scmos_coordinate_n)
        scmos_scroll_layout.addRow(cw.label_widget(str('Bin')), self.QSpinBox_scmos_coordinate_bin)
        scmos_scroll_layout.addRow(cw.label_widget(str('From / s')), cw.label_widget(str('To / s')))
        scmos_scroll_layout.addRow(self.QDoubleSpinBox_ttl_start_scmos, self.QDoubleSpinBox_ttl_stop_scmos)
        Layout_Camera.addWidget(self.emccd_scroll_area)
        Layout_Camera.addWidget(self.scmos_scroll_area)
        group_Camera.setLayout(Layout_Camera)

        Layout_Position = QtWidgets.QHBoxLayout()
        self.QLCDNumber_deck_position = cw.lcdnumber_widget()
        self.QPushButton_move_deck_up = cw.pushbutton_widget('Up')
        self.QPushButton_move_deck_down = cw.pushbutton_widget('Down')
        self.QDoubleSpinBox_deck_movement = cw.doublespinbox_widget(-11.5, 11.5, 0.001, 3, 0.01)
        self.QDoubleSpinBox_deck_velocity = cw.doublespinbox_widget(0.02, 1.50, 0.02, 2, 0.02)
        self.QPushButton_move_deck = cw.pushbutton_widget('Move', checkable=True)
        self.mad_deck_scroll_area, mad_deck_scroll_layout = cw.create_scroll_area()
        mad_deck_scroll_layout.addRow(cw.label_widget(str('Mad Deck')))
        mad_deck_scroll_layout.addRow(cw.frame_widget())
        mad_deck_scroll_layout.addRow(cw.label_widget(str('Position (mm)')), self.QLCDNumber_deck_position)
        mad_deck_scroll_layout.addRow(cw.label_widget(str('Distance (mm)')), self.QDoubleSpinBox_deck_movement)
        mad_deck_scroll_layout.addRow(cw.label_widget(str('Velocity (mm)')), self.QDoubleSpinBox_deck_velocity)
        mad_deck_scroll_layout.addRow(self.QPushButton_move_deck)
        mad_deck_scroll_layout.addRow(cw.label_widget(str('Single step')))
        mad_deck_scroll_layout.addRow(self.QPushButton_move_deck_up, self.QPushButton_move_deck_down)
        self.QDoubleSpinBox_stage_x = cw.doublespinbox_widget(0, 100, 0.02, 2, 50.00)
        self.QLCDNumber_piezo_position_x = cw.lcdnumber_widget()
        self.QDoubleSpinBox_step_x = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.030)
        self.QDoubleSpinBox_range_x = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.600)
        self.QDoubleSpinBox_stage_y = cw.doublespinbox_widget(0, 100, 0.02, 2, 50.00)
        self.QLCDNumber_piezo_position_y = cw.lcdnumber_widget()
        self.QDoubleSpinBox_step_y = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.030)
        self.QDoubleSpinBox_range_y = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.600)
        self.QDoubleSpinBox_stage_z = cw.doublespinbox_widget(0, 100, 0.04, 2, 50.00)
        self.QLCDNumber_piezo_position_z = cw.lcdnumber_widget()
        self.QDoubleSpinBox_step_z = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.080)
        self.QDoubleSpinBox_range_z = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.800)
        self.mcl_piezo_scroll_area, mcl_piezo_scroll_layout = cw.create_scroll_area()
        mcl_piezo_scroll_layout.addRow(cw.label_widget(str('MCL Piezo')))
        mcl_piezo_scroll_layout.addRow(cw.frame_widget())
        hbox_xp = QtWidgets.QHBoxLayout()
        hbox_xp.addWidget(cw.label_widget(str('X (um)')))
        hbox_xp.addWidget(self.QDoubleSpinBox_stage_x)
        hbox_xp.addWidget(self.QLCDNumber_piezo_position_x)
        mcl_piezo_scroll_layout.addRow(hbox_xp)
        mcl_piezo_scroll_layout.addRow(cw.label_widget(str('Step / um')), cw.label_widget(str('Range / um')))
        mcl_piezo_scroll_layout.addRow(self.QDoubleSpinBox_step_x, self.QDoubleSpinBox_range_x)
        mcl_piezo_scroll_layout.addRow(cw.frame_widget())
        hbox_yp = QtWidgets.QHBoxLayout()
        hbox_yp.addWidget(cw.label_widget(str('Y (um)')))
        hbox_yp.addWidget(self.QDoubleSpinBox_stage_y)
        hbox_yp.addWidget(self.QLCDNumber_piezo_position_y)
        mcl_piezo_scroll_layout.addRow(hbox_yp)
        mcl_piezo_scroll_layout.addRow(cw.label_widget(str('Step / um')), cw.label_widget(str('Range / um')))
        mcl_piezo_scroll_layout.addRow(self.QDoubleSpinBox_step_y, self.QDoubleSpinBox_range_y)
        mcl_piezo_scroll_layout.addRow(cw.frame_widget())
        hbox_zp = QtWidgets.QHBoxLayout()
        hbox_zp.addWidget(cw.label_widget(str('Z (um)')))
        hbox_zp.addWidget(self.QDoubleSpinBox_stage_z)
        hbox_zp.addWidget(self.QLCDNumber_piezo_position_z)
        mcl_piezo_scroll_layout.addRow(hbox_zp)
        mcl_piezo_scroll_layout.addRow(cw.label_widget(str('Step / um')), cw.label_widget(str('Range / um')))
        mcl_piezo_scroll_layout.addRow(self.QDoubleSpinBox_step_z, self.QDoubleSpinBox_range_z)
        self.QDoubleSpinBox_galvo_x = cw.doublespinbox_widget(-10, 10, 0.001, 3, 0)
        self.QDoubleSpinBox_galvo_y = cw.doublespinbox_widget(-10, 10, 0.001, 3, 0)
        self.QDoubleSpinBox_galvo_start_x = cw.doublespinbox_widget(-10, 10, 0.001, 3, -1.2)
        self.QDoubleSpinBox_galvo_stop_x = cw.doublespinbox_widget(-10, 10, 0.001, 3, 1.2)
        self.QDoubleSpinBox_galvo_start_y = cw.doublespinbox_widget(-10, 10, 0.001, 3, -1.2)
        self.QDoubleSpinBox_galvo_stop_y = cw.doublespinbox_widget(-10, 10, 0.001, 3, 1.2)
        # self.QDoubleSpinBox_galvo_accelaration = cw.doublespinbox_widget(0, 2.4, 0.02, 2, 2.4)
        # self.QDoubleSpinBox_galvo_velocity = cw.doublespinbox_widget(0, 4, 0.02, 2, 4)
        # self.QSpinBox_galvo_laser_start = cw.spinbox_widget(0, 128, 1, 8)
        # self.QSpinBox_galvo_laser_interval = cw.spinbox_widget(0, 128, 1, 16)
        self.QSpinBox_galvo_frequency = cw.spinbox_widget(0, 4000, 1, 200)
        self.QDoubleSpinBox_dot_start = cw.doublespinbox_widget(-10, 10, 0.02, 2, -0.8)
        self.QDoubleSpinBox_dot_range = cw.doublespinbox_widget(0, 20, 0.02, 2, 1.6)
        self.QDoubleSpinBox_dot_step = cw.doublespinbox_widget(0, 20, 0.01, 2, 0.04)
        self.QSpinBox_galvo_delay = cw.spinbox_widget(-4000, 4000, 1, 0)
        self.QSpinBox_galvo_interval = cw.spinbox_widget(0, 4000, 1, 4)
        self.galvo_scroll_area, galvo_scroll_layout = cw.create_scroll_area()
        galvo_scroll_layout.addRow(cw.label_widget(str('Galvo Scanner')))
        galvo_scroll_layout.addRow(cw.frame_widget())
        galvo_scroll_layout.addRow(cw.label_widget(str('X / v')), self.QDoubleSpinBox_galvo_x)
        galvo_scroll_layout.addRow(cw.label_widget(str('From / V')), cw.label_widget(str('To / V')))
        galvo_scroll_layout.addRow(self.QDoubleSpinBox_galvo_start_x, self.QDoubleSpinBox_galvo_stop_x)
        galvo_scroll_layout.addRow(cw.frame_widget())
        galvo_scroll_layout.addRow(cw.label_widget(str('Y / v')), self.QDoubleSpinBox_galvo_y)
        galvo_scroll_layout.addRow(cw.label_widget(str('From / V')), cw.label_widget(str('To / V')))
        galvo_scroll_layout.addRow(self.QDoubleSpinBox_galvo_start_y, self.QDoubleSpinBox_galvo_stop_y)
        galvo_scroll_layout.addRow(cw.frame_widget())
        # galvo_scroll_layout.addRow(cw.label_widget(str('Acc / e7V/s^2')), self.QDoubleSpinBox_galvo_accelaration)
        # galvo_scroll_layout.addRow(cw.label_widget(str('Vel / e2V/s')), self.QDoubleSpinBox_galvo_velocity)
        # galvo_scroll_layout.addRow(cw.label_widget(str('1st Dot / sp')), self.QSpinBox_galvo_laser_start)
        # galvo_scroll_layout.addRow(cw.label_widget(str('Interval / sp')), self.QSpinBox_galvo_laser_interval)
        galvo_scroll_layout.addRow(cw.label_widget(str('Frequency / Hz')), self.QSpinBox_galvo_frequency)
        galvo_scroll_layout.addRow(cw.label_widget(str('Dot Start / V')), self.QDoubleSpinBox_dot_start)
        galvo_scroll_layout.addRow(cw.label_widget(str('Dot Range / V')), self.QDoubleSpinBox_dot_range)
        galvo_scroll_layout.addRow(cw.label_widget(str('Dot Step / V')), self.QDoubleSpinBox_dot_step)
        galvo_scroll_layout.addRow(cw.label_widget(str('Delay / sample')), self.QSpinBox_galvo_delay)
        galvo_scroll_layout.addRow(cw.label_widget(str('Interval / sample')), self.QSpinBox_galvo_interval)
        Layout_Position.addWidget(self.mad_deck_scroll_area)
        Layout_Position.addWidget(self.mcl_piezo_scroll_area)
        Layout_Position.addWidget(self.galvo_scroll_area)
        group_Position.setLayout(Layout_Position)

        Layout_Illumination = QtWidgets.QHBoxLayout()
        self.QRadioButton_laser_405 = cw.radiobutton_widget('405 nm')
        self.QDoubleSpinBox_laserpower_405 = cw.doublespinbox_widget(0, 200, 0.1, 1, 0.0)
        self.QPushButton_laser_405 = cw.pushbutton_widget('ON', checkable=True)
        self.QRadioButton_laser_488_0 = cw.radiobutton_widget('488 nm #0')
        self.QDoubleSpinBox_laserpower_488_0 = cw.doublespinbox_widget(0, 200, 0.1, 1, 0.0)
        self.QPushButton_laser_488_0 = cw.pushbutton_widget('ON', checkable=True)
        self.QRadioButton_laser_488_1 = cw.radiobutton_widget('488 nm #1')
        self.QDoubleSpinBox_laserpower_488_1 = cw.doublespinbox_widget(0, 200, 0.1, 1, 0.0)
        self.QPushButton_laser_488_1 = cw.pushbutton_widget('ON', checkable=True)
        self.QRadioButton_laser_488_2 = cw.radiobutton_widget('488 nm #2')
        self.QDoubleSpinBox_laserpower_488_2 = cw.doublespinbox_widget(0, 200, 0.1, 1, 0.0)
        self.QPushButton_laser_488_2 = cw.pushbutton_widget('ON', checkable=True)
        self.QLabel_laser_405_starts = cw.label_widget(str('From / s'))
        self.QLabel_laser_405_stops = cw.label_widget(str('To / s'))
        self.QDoubleSpinBox_ttl_start_on_405 = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.002)
        self.QDoubleSpinBox_ttl_stop_on_405 = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.004)
        self.QLabel_laser_488_0_starts = cw.label_widget(str('From / s'))
        self.QLabel_laser_488_0_stops = cw.label_widget(str('To / s'))
        self.QDoubleSpinBox_ttl_start_off_488_0 = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.007)
        self.QDoubleSpinBox_ttl_stop_off_488_0 = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.01)
        self.QLabel_laser_488_1_starts = cw.label_widget(str('From / s'))
        self.QLabel_laser_488_1_stops = cw.label_widget(str('To / s'))
        self.QDoubleSpinBox_ttl_start_off_488_1 = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.007)
        self.QDoubleSpinBox_ttl_stop_off_488_1 = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.01)
        self.QLabel_laser_488_2_starts = cw.label_widget(str('From / s'))
        self.QLabel_laser_488_2_stops = cw.label_widget(str('To / s'))
        self.QDoubleSpinBox_ttl_start_read_488_2 = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.012)
        self.QDoubleSpinBox_ttl_stop_read_488_2 = cw.doublespinbox_widget(0, 50, 0.001, 3, 0.015)
        self.laser_405_scroll_area, laser_405_scroll_layout = cw.create_scroll_area()
        self.laser_488_0_scroll_area, laser_488_0_scroll_layout = cw.create_scroll_area()
        self.laser_488_1_scroll_area, laser_488_1_scroll_layout = cw.create_scroll_area()
        self.laser_488_2_scroll_area, laser_488_2_scroll_layout = cw.create_scroll_area()
        laser_405_scroll_layout.addRow(self.QRadioButton_laser_405, self.QDoubleSpinBox_laserpower_405)
        laser_405_scroll_layout.addRow(self.QPushButton_laser_405)
        laser_405_scroll_layout.addRow(self.QLabel_laser_405_starts, self.QLabel_laser_405_stops)
        laser_405_scroll_layout.addRow(self.QDoubleSpinBox_ttl_start_on_405, self.QDoubleSpinBox_ttl_stop_on_405)
        laser_488_0_scroll_layout.addRow(self.QRadioButton_laser_488_0, self.QDoubleSpinBox_laserpower_488_0)
        laser_488_0_scroll_layout.addRow(self.QPushButton_laser_488_0)
        laser_488_0_scroll_layout.addRow(self.QLabel_laser_488_0_starts, self.QLabel_laser_488_0_stops)
        laser_488_0_scroll_layout.addRow(self.QDoubleSpinBox_ttl_start_off_488_0,
                                         self.QDoubleSpinBox_ttl_stop_off_488_0)
        laser_488_1_scroll_layout.addRow(self.QRadioButton_laser_488_1, self.QDoubleSpinBox_laserpower_488_1)
        laser_488_1_scroll_layout.addRow(self.QPushButton_laser_488_1)
        laser_488_1_scroll_layout.addRow(self.QLabel_laser_488_1_starts, self.QLabel_laser_488_1_stops)
        laser_488_1_scroll_layout.addRow(self.QDoubleSpinBox_ttl_start_off_488_1,
                                         self.QDoubleSpinBox_ttl_stop_off_488_1)
        laser_488_2_scroll_layout.addRow(self.QRadioButton_laser_488_2, self.QDoubleSpinBox_laserpower_488_2)
        laser_488_2_scroll_layout.addRow(self.QPushButton_laser_488_2)
        laser_488_2_scroll_layout.addRow(self.QLabel_laser_488_2_starts, self.QLabel_laser_488_2_stops)
        laser_488_2_scroll_layout.addRow(self.QDoubleSpinBox_ttl_start_read_488_2,
                                         self.QDoubleSpinBox_ttl_stop_read_488_2)
        Layout_Illumination.addWidget(self.laser_405_scroll_area)
        Layout_Illumination.addWidget(self.laser_488_0_scroll_area)
        Layout_Illumination.addWidget(self.laser_488_1_scroll_area)
        Layout_Illumination.addWidget(self.laser_488_2_scroll_area)
        group_Illumination.setLayout(Layout_Illumination)

        Layout_LiveVideo = QtWidgets.QHBoxLayout()
        self.QPushButton_video = cw.pushbutton_widget('Video', checkable=True)
        self.QPushButton_fft = cw.pushbutton_widget('FFT', checkable=True, enable=False)
        self.QComboBox_profile_axis = cw.combobox_widget(list_items=['X', 'Y'])
        self.QPushButton_plot_profile = cw.pushbutton_widget('Plot Profile', checkable=True, enable=False)
        self.QPushButton_plot_trigger = cw.pushbutton_widget('Plot Triggers')
        Layout_LiveVideo.addWidget(self.QPushButton_video)
        Layout_LiveVideo.addWidget(self.QPushButton_fft)
        Layout_LiveVideo.addWidget(self.QComboBox_profile_axis)
        Layout_LiveVideo.addWidget(self.QPushButton_plot_profile)
        Layout_LiveVideo.addWidget(self.QPushButton_plot_trigger)
        group_LiveVideo.setLayout(Layout_LiveVideo)

        Layout_DataAcquisition = QtWidgets.QGridLayout()
        self.QLabel_acquisition_number = cw.label_widget(str('Acq Number'))
        self.QSpinBox_acquisition_number = cw.spinbox_widget(1, 50000, 1, 1)
        self.QLabel_acquisition_modes = cw.label_widget(str('Acq Modes'))
        self.QComboBox_acquisition_modes = cw.combobox_widget(list_items=["Live",
                                                                          "Widefield 2D", "Widefield 3D",
                                                                          "Confocal 2D", "Confocal 3D",
                                                                          "GalvoScan 2D", "GalvoScan 3D",
                                                                          "RESOLFT 2D", "RESOLFT 3D",
                                                                          "BeadScan 2D"])
        self.QLabel_camera_selection = cw.label_widget(str('Camera'))
        self.QComboBox_camera_selection = cw.combobox_widget(list_items=['Main', 'WFS', 'TIS'])
        self.QPushButton_acquire = cw.pushbutton_widget('Acquire')
        self.QPushButton_save = cw.pushbutton_widget('Save')
        Layout_DataAcquisition.addWidget(self.QLabel_acquisition_modes, 0, 0, 1, 1)
        Layout_DataAcquisition.addWidget(self.QComboBox_acquisition_modes, 1, 0, 1, 1)
        Layout_DataAcquisition.addWidget(self.QLabel_camera_selection, 0, 1, 1, 1)
        Layout_DataAcquisition.addWidget(self.QComboBox_camera_selection, 1, 1, 1, 1)
        Layout_DataAcquisition.addWidget(self.QLabel_acquisition_number, 0, 2, 1, 1)
        Layout_DataAcquisition.addWidget(self.QSpinBox_acquisition_number, 1, 2, 1, 1)
        Layout_DataAcquisition.addWidget(self.QPushButton_acquire, 0, 3, 1, 1)
        Layout_DataAcquisition.addWidget(self.QPushButton_save, 1, 3, 1, 1)
        group_DataAcquisition.setLayout(Layout_DataAcquisition)

        self.QComboBox_emccd.currentIndexChanged.connect(self.update_combobox_scmos)
        self.QComboBox_scmos.currentIndexChanged.connect(self.update_combobox_emccd)
        self._set_signals()
        self.update_trigger_parameter_sets()

    def _set_signals(self):
        self.QPushButton_emccd_cooler_check.clicked.connect(self.Signal_check_emccd_temperature.emit)
        self.QPushButton_emccd_cooler_switch.clicked.connect(self.switch_emccd_cooler)
        self.QDoubleSpinBox_stage_x.valueChanged.connect(lambda value: self.Signal_piezo_move.emit("x", value))
        self.QDoubleSpinBox_stage_y.valueChanged.connect(lambda value: self.Signal_piezo_move.emit("y", value))
        self.QDoubleSpinBox_stage_z.valueChanged.connect(lambda value: self.Signal_piezo_move.emit("z", value))
        self.QPushButton_move_deck_up.clicked.connect(lambda: self.Signal_deck_move_single_step.emit(True))
        self.QPushButton_move_deck_down.clicked.connect(lambda: self.Signal_deck_move_single_step.emit(False))
        self.QPushButton_move_deck.clicked.connect(self.deck_move)
        self.QDoubleSpinBox_galvo_x.valueChanged.connect(self.Signal_galvo_set.emit)
        self.QDoubleSpinBox_galvo_y.valueChanged.connect(self.Signal_galvo_set.emit)
        self.QPushButton_laser_488_0.clicked.connect(self.set_laser_488_0)
        self.QPushButton_laser_488_1.clicked.connect(self.set_laser_488_1)
        self.QPushButton_laser_488_2.clicked.connect(self.set_laser_488_2)
        self.QPushButton_laser_405.clicked.connect(self.set_laser_405)
        self.QPushButton_plot_trigger.clicked.connect(self.plot_trigger_sequence)
        self.QPushButton_video.clicked.connect(self.run_video)
        self.QPushButton_fft.clicked.connect(self.run_fft)
        self.QPushButton_plot_profile.clicked.connect(self.run_plot_profile)
        self.QPushButton_acquire.clicked.connect(self.Signal_data_acquire.emit)
        self.QPushButton_save.clicked.connect(self.save)
        self.QComboBox_acquisition_modes.currentIndexChanged.connect(self.update_trigger_parameter_sets)

    def update_combobox_scmos(self, index):
        if index == self.QComboBox_scmos.currentIndex():
            new_index = (index + 1) % self.QComboBox_scmos.count()
            self.QComboBox_scmos.setCurrentIndex(new_index)

    def update_combobox_emccd(self, index):
        if index == self.QComboBox_emccd.currentIndex():
            new_index = (index + 1) % self.QComboBox_emccd.count()
            self.QComboBox_emccd.setCurrentIndex(new_index)

    def switch_emccd_cooler(self, checked):
        if checked:
            self.QPushButton_emccd_cooler_switch.setText("Cooler ON")
            self.Signal_switch_emccd_cooler.emit(True)
        else:
            self.QPushButton_emccd_cooler_switch.setText("Cooler OFF")
            self.Signal_switch_emccd_cooler.emit(False)

    def deck_move(self):
        if self.QPushButton_move_deck.isChecked():
            self.Signal_deck_move_continuous.emit(True)
        else:
            self.Signal_deck_move_continuous.emit(False)

    def set_laser_488_0(self):
        if self.QPushButton_laser_488_0.isChecked():
            self.Signal_set_laser.emit(["488_0"], True)
        else:
            self.Signal_set_laser.emit(["488_0"], False)

    def set_laser_488_1(self):
        if self.QPushButton_laser_488_1.isChecked():
            self.Signal_set_laser.emit(["488_1"], True)
        else:
            self.Signal_set_laser.emit(["488_1"], False)

    def set_laser_488_2(self):
        if self.QPushButton_laser_488_2.isChecked():
            self.Signal_set_laser.emit(["488_2"], True)
        else:
            self.Signal_set_laser.emit(["488_2"], False)

    def set_laser_405(self):
        if self.QPushButton_laser_405.isChecked():
            self.Signal_set_laser.emit(["405"], True)
        else:
            self.Signal_set_laser.emit(["405"], False)

    def plot_trigger_sequence(self):
        self.Signal_plot_trigger.emit()

    def run_video(self):
        if self.QPushButton_video.isChecked():
            self.Signal_video.emit(True)
            self.QPushButton_fft.setEnabled(True)
            self.QPushButton_plot_profile.setEnabled(True)
        else:
            self.Signal_video.emit(False)
            if self.QPushButton_fft.isChecked():
                self.Signal_fft.emit(False)
            self.QPushButton_fft.setEnabled(False)
            self.QPushButton_fft.setChecked(False)
            if self.QPushButton_plot_profile.isChecked():
                self.Signal_plot_profile.emit(False)
            self.QPushButton_plot_profile.setEnabled(False)
            self.QPushButton_plot_profile.setChecked(False)

    def run_fft(self):
        if self.QPushButton_fft.isChecked():
            self.Signal_fft.emit(True)
        else:
            self.Signal_fft.emit(False)

    def run_plot_profile(self):
        if self.QPushButton_plot_profile.isChecked():
            self.Signal_plot_profile.emit(True)
        else:
            self.Signal_plot_profile.emit(False)

    def save(self):
        dialog = cw.create_file_dialogue(name="Save File", file_filter="All Files (*)",
                                         default_dir=str(self.data_folder))
        if dialog.exec_() == QtWidgets.QFileDialog.Accepted:
            selected_file = dialog.selectedFiles()
            if selected_file:
                print(selected_file[0])
                self.Signal_save_file.emit(selected_file[0])

    def update_trigger_parameter_sets(self):
        presets = self.QComboBox_acquisition_modes.currentText()
        if presets == "Live":
            self.QDoubleSpinBox_step_x.setValue(0.000)
            self.QDoubleSpinBox_step_y.setValue(0.000)
            self.QDoubleSpinBox_step_z.setValue(0.000)
            self.QDoubleSpinBox_range_x.setValue(0.000)
            self.QDoubleSpinBox_range_y.setValue(0.000)
            self.QDoubleSpinBox_range_z.setValue(0.000)
            # self.QDoubleSpinBox_galvo_start_x.setValue(0.000)
            # self.QDoubleSpinBox_galvo_start_y.setValue(0.000)
            # self.QDoubleSpinBox_galvo_stop_x.setValue(0.000)
            # self.QDoubleSpinBox_galvo_stop_y.setValue(0.000)
            # self.QSpinBox_galvo_laser_start.setValue(0)
            # self.QSpinBox_galvo_laser_interval.setValue(0)
            self.QDoubleSpinBox_ttl_start_on_405.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_on_405.setValue(0.005)
            self.QDoubleSpinBox_ttl_start_off_488_0.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_0.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_off_488_1.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_1.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_read_488_2.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_read_488_2.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_emccd.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_emccd.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_scmos.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_scmos.setValue(0.065)
        if presets == "Widefield 2D":
            self.QDoubleSpinBox_step_x.setValue(0.000)
            self.QDoubleSpinBox_step_y.setValue(0.000)
            self.QDoubleSpinBox_step_z.setValue(0.000)
            self.QDoubleSpinBox_range_x.setValue(0.000)
            self.QDoubleSpinBox_range_y.setValue(0.000)
            self.QDoubleSpinBox_range_z.setValue(0.000)
            # self.QDoubleSpinBox_galvo_start_x.setValue(0.000)
            # self.QDoubleSpinBox_galvo_start_y.setValue(0.000)
            # self.QDoubleSpinBox_galvo_stop_x.setValue(0.000)
            # self.QDoubleSpinBox_galvo_stop_y.setValue(0.000)
            # self.QSpinBox_galvo_laser_start.setValue(0)
            # self.QSpinBox_galvo_laser_interval.setValue(0)
            self.QDoubleSpinBox_ttl_start_on_405.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_on_405.setValue(0.005)
            self.QDoubleSpinBox_ttl_start_off_488_0.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_0.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_off_488_1.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_1.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_read_488_2.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_read_488_2.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_emccd.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_emccd.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_scmos.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_scmos.setValue(0.065)
        if presets == 'Widefield 3D':
            self.QDoubleSpinBox_step_x.setValue(0.000)
            self.QDoubleSpinBox_step_y.setValue(0.000)
            self.QDoubleSpinBox_step_z.setValue(0.160)
            self.QDoubleSpinBox_range_x.setValue(0.000)
            self.QDoubleSpinBox_range_y.setValue(0.000)
            self.QDoubleSpinBox_range_z.setValue(3.200)
            # self.QDoubleSpinBox_galvo_start_x.setValue(0.000)
            # self.QDoubleSpinBox_galvo_start_y.setValue(0.000)
            # self.QDoubleSpinBox_galvo_stop_x.setValue(0.000)
            # self.QDoubleSpinBox_galvo_stop_y.setValue(0.000)
            # self.QSpinBox_galvo_laser_start.setValue(0)
            # self.QSpinBox_galvo_laser_interval.setValue(0)
            self.QDoubleSpinBox_ttl_start_on_405.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_on_405.setValue(0.005)
            self.QDoubleSpinBox_ttl_start_off_488_0.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_0.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_off_488_1.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_1.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_read_488_2.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_read_488_2.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_emccd.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_emccd.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_scmos.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_scmos.setValue(0.065)
        if presets == "Confocal 2D":
            self.QDoubleSpinBox_step_x.setValue(0.000)
            self.QDoubleSpinBox_step_y.setValue(0.000)
            self.QDoubleSpinBox_step_z.setValue(0.000)
            self.QDoubleSpinBox_range_x.setValue(0.000)
            self.QDoubleSpinBox_range_y.setValue(0.000)
            self.QDoubleSpinBox_range_z.setValue(0.000)
            # self.QDoubleSpinBox_galvo_start_x.setValue(-1.000)
            # self.QDoubleSpinBox_galvo_start_y.setValue(-1.000)
            # self.QDoubleSpinBox_galvo_stop_x.setValue(1.000)
            # self.QDoubleSpinBox_galvo_stop_y.setValue(1.000)
            # self.QSpinBox_galvo_laser_start.setValue(8)
            # self.QSpinBox_galvo_laser_interval.setValue(16)
            self.QDoubleSpinBox_ttl_start_on_405.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_on_405.setValue(0.005)
            self.QDoubleSpinBox_ttl_start_off_488_0.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_0.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_off_488_1.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_1.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_read_488_2.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_read_488_2.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_emccd.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_emccd.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_scmos.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_scmos.setValue(0.065)
        if presets == "Confocal 3D":
            self.QDoubleSpinBox_step_x.setValue(0.000)
            self.QDoubleSpinBox_step_y.setValue(0.000)
            self.QDoubleSpinBox_step_z.setValue(0.160)
            self.QDoubleSpinBox_range_x.setValue(0.000)
            self.QDoubleSpinBox_range_y.setValue(0.000)
            self.QDoubleSpinBox_range_z.setValue(3.200)
            # self.QDoubleSpinBox_galvo_start_x.setValue(-1.000)
            # self.QDoubleSpinBox_galvo_start_y.setValue(-1.000)
            # self.QDoubleSpinBox_galvo_stop_x.setValue(1.000)
            # self.QDoubleSpinBox_galvo_stop_y.setValue(1.000)
            # self.QSpinBox_galvo_laser_start.setValue(0)
            # self.QSpinBox_galvo_laser_interval.setValue(0)
            self.QDoubleSpinBox_ttl_start_on_405.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_on_405.setValue(0.005)
            self.QDoubleSpinBox_ttl_start_off_488_0.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_0.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_off_488_1.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_1.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_read_488_2.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_read_488_2.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_emccd.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_emccd.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_scmos.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_scmos.setValue(0.065)
        if presets == "GalvoScan 2D":
            self.QDoubleSpinBox_step_x.setValue(0.000)
            self.QDoubleSpinBox_step_y.setValue(0.000)
            self.QDoubleSpinBox_step_z.setValue(0.000)
            self.QDoubleSpinBox_range_x.setValue(0.000)
            self.QDoubleSpinBox_range_y.setValue(0.000)
            self.QDoubleSpinBox_range_z.setValue(0.000)
            # self.QDoubleSpinBox_galvo_start_x.setValue(-1.000)
            # self.QDoubleSpinBox_galvo_start_y.setValue(-1.000)
            # self.QDoubleSpinBox_galvo_stop_x.setValue(1.000)
            # self.QDoubleSpinBox_galvo_stop_y.setValue(1.000)
            # self.QSpinBox_galvo_laser_start.setValue(8)
            # self.QSpinBox_galvo_laser_interval.setValue(16)
            self.QDoubleSpinBox_ttl_start_on_405.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_on_405.setValue(0.005)
            self.QDoubleSpinBox_ttl_start_off_488_0.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_0.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_off_488_1.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_1.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_read_488_2.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_read_488_2.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_emccd.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_emccd.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_scmos.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_scmos.setValue(0.065)
        if presets == "GalvoScan 3D":
            self.QDoubleSpinBox_step_x.setValue(0.000)
            self.QDoubleSpinBox_step_y.setValue(0.000)
            self.QDoubleSpinBox_step_z.setValue(0.160)
            self.QDoubleSpinBox_range_x.setValue(0.000)
            self.QDoubleSpinBox_range_y.setValue(0.000)
            self.QDoubleSpinBox_range_z.setValue(3.200)
            # self.QDoubleSpinBox_galvo_start_x.setValue(-1.000)
            # self.QDoubleSpinBox_galvo_start_y.setValue(-1.000)
            # self.QDoubleSpinBox_galvo_stop_x.setValue(1.000)
            # self.QDoubleSpinBox_galvo_stop_y.setValue(1.000)
            # self.QSpinBox_galvo_laser_start.setValue(8)
            # self.QSpinBox_galvo_laser_interval.setValue(16)
            self.QDoubleSpinBox_ttl_start_on_405.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_on_405.setValue(0.005)
            self.QDoubleSpinBox_ttl_start_off_488_0.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_0.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_off_488_1.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_off_488_1.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_read_488_2.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_read_488_2.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_emccd.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_emccd.setValue(0.065)
            self.QDoubleSpinBox_ttl_start_scmos.setValue(0.010)
            self.QDoubleSpinBox_ttl_stop_scmos.setValue(0.065)
        if presets == "BeadScan 2D":
            self.QDoubleSpinBox_step_x.setValue(0.032)
            self.QDoubleSpinBox_step_y.setValue(0.032)
            self.QDoubleSpinBox_step_z.setValue(0.000)
            self.QDoubleSpinBox_range_x.setValue(0.640)
            self.QDoubleSpinBox_range_y.setValue(0.640)
            self.QDoubleSpinBox_range_z.setValue(0.000)
            # self.QDoubleSpinBox_galvo_start_x.setValue(0.000)
            # self.QDoubleSpinBox_galvo_start_y.setValue(0.000)
            # self.QDoubleSpinBox_galvo_stop_x.setValue(0.000)
            # self.QDoubleSpinBox_galvo_stop_y.setValue(0.000)
            # self.QSpinBox_galvo_laser_start.setValue(0)
            # self.QSpinBox_galvo_laser_interval.setValue(0)
            self.QDoubleSpinBox_ttl_start_on_405.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_on_405.setValue(0.000)
            self.QDoubleSpinBox_ttl_start_off_488_0.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_off_488_0.setValue(0.000)
            self.QDoubleSpinBox_ttl_start_off_488_1.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_off_488_1.setValue(0.000)
            self.QDoubleSpinBox_ttl_start_read_488_2.setValue(0.008)
            self.QDoubleSpinBox_ttl_stop_read_488_2.setValue(0.032)
            self.QDoubleSpinBox_ttl_start_emccd.setValue(0.008)
            self.QDoubleSpinBox_ttl_stop_emccd.setValue(0.032)
            self.QDoubleSpinBox_ttl_start_scmos.setValue(0.000)
            self.QDoubleSpinBox_ttl_stop_scmos.setValue(0.000)


import sys

if __name__ == "__main__":
    app = QtWidgets.QApplication(sys.argv)
    window = ConWidget(None, None, None)
    window.show()
    sys.exit(app.exec_())
